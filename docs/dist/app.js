!function o(a,u,s){function c(e,t){if(!u[e]){if(!a[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(f)return f(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var i=u[e]={exports:{}};a[e][0].call(i.exports,function(t){return c(a[e][1][t]||t)},i,i.exports,o,a,u,s)}return u[e].exports}for(var f="function"==typeof require&&require,t=0;t<s.length;t++)c(s[t]);return c}({1:[function(t,e,r){"use strict";var _=t("./parser");!function(){var t=document.querySelectorAll(".schema"),e=!0,r=!1,n=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value,u=[],s=a.innerHTML.trim().split("\n"),c=!0,f=!1,l=void 0;try{for(var h,p=s[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var y=h.value;if(y=y.trim()){var v=new _.SchemaParser(y).parse();u.push(v.toFormattedString())}else u.push("<br>")}}catch(t){f=!0,l=t}finally{try{c||null==p.return||p.return()}finally{if(f)throw l}}a.innerHTML=u.join("\n")}}catch(t){r=!0,n=t}finally{try{e||null==o.return||o.return()}finally{if(r)throw n}}}()},{"./parser":2}],2:[function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function s(t){var n="function"==typeof Map?new Map:void 0;return(s=function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,r)}function r(){return c(t,arguments,l(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,t)})(t)}function c(t,e,r){return(c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&f(i,r.prototype),i}).apply(null,arguments)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.SchemaParser=r.Relation=r.Attribute=void 0;var h=function(t){function r(t){var e;return a(this,r),(e=u(this,l(r).call(this))).message=t,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(r,s(Error)),r}(),p=function(){function e(t){a(this,e),this.name=t,this.primary_key=!1,this.foreign_key=!1,this.foreign_key_n=0}return i(e,[{key:"toString",value:function(){var t=this.name;return this.foreign_key&&(t+=" [fk"+(0===this.foreign_key_n?"":this.foreign_key_n.toString())+"]"),t}}]),e}();r.Attribute=p;var y=function(){function e(t){a(this,e),this.name=t,this.attributes=[],this.primary_keys=[],this.foreign_keys=[]}return i(e,[{key:"add_attribute",value:function(t){t.foreign_key&&(1===this.foreign_keys.length&&(this.foreign_keys[0].foreign_key_n=1),0!==this.foreign_keys.length&&(t.foreign_key_n=this.foreign_keys.length+1),this.foreign_keys.push(t),console.log(t)),t.primary_key?this.primary_keys.push(t):this.attributes.push(t)}},{key:"toFormattedString",value:function(){var t="",e='<span class="relation-sep">,</span> ',r=function(t){return'<span class="relation-attribute'.concat(t.foreign_key?" relation-fk":"",'">').concat(t.toString(),"</span>")},n=!0,i=!1,o=void 0;try{for(var a,u=this.primary_keys[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){t+=r(a.value)+e}}catch(t){i=!0,o=t}finally{try{n||null==u.return||u.return()}finally{if(i)throw o}}var s=[],c=!0,f=!1,l=void 0;try{for(var h,p=this.attributes[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var y=h.value;s.push(r(y))}}catch(t){f=!0,l=t}finally{try{c||null==p.return||p.return()}finally{if(f)throw l}}return'<code class="relation">'+'<span class="relation-name">'.concat(this.name,"</span>")+'<span class="relation-tuple"><span class="relation-open–tuple">(</span>'+'<span class="relation-pk">'.concat(t,"[pk]</span>").concat(s.length?" ":"").concat(s.join(e))+'<span class="relation-close–tuple">)</span></span></code>'}}]),e}();r.Relation=y;var v=function(){function e(t){a(this,e),this.data=t,this.size=t.length,this.pointer=0,this.relation=null}return i(e,[{key:"parse",value:function(){try{this._parse()}catch(t){if(!(t instanceof h))throw t;console.log(t.message)}return this.relation}},{key:"_parse",value:function(){var t=this.read(/[A-Z]+/)[0];this.relation=new y(t),this.read(/\(/);for(var e=/\[fk\d?]/,r=/\[pk]/,n=/\w+/;!this.try_read(r);){var i=this.read(n),o=new p(i[0]);o.primary_key=!0,this.try_read(e)&&(o.foreign_key=!0),this.read(/,/),this.relation.add_attribute(o)}for(;!this.try_read(/\)/);){var a=this.read(n),u=new p(a[0]);this.try_read(e)&&(u.foreign_key=!0),this.try_read(/,/),this.relation.add_attribute(u)}}},{key:"end",value:function(){return this.pointer===this.size}},{key:"remaining",value:function(){return this.data.substr(this.pointer)}},{key:"eat_whitespace",value:function(){var t=this.remaining().match(/^\s+/);t&&(this.pointer+=t[0].length)}},{key:"try_read",value:function(t){var e=this.peek(t);return e&&(this.pointer+=e[0].length,this.eat_whitespace()),e}},{key:"peek",value:function(t){return t=new RegExp("^"+t.source),this.remaining().match(t)}},{key:"read",value:function(t){var e=this.peek(t);if(!e)throw new h("invalid match "+t+" of "+this.remaining());return this.pointer+=e[0].length,this.eat_whitespace(),e}}]),e}();r.SchemaParser=v},{}]},{},[1]);
//# sourceMappingURL=app.js.map
