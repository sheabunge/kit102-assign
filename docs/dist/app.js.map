{"version":3,"sources":["app.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","_parser","areas","document","querySelectorAll","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","area","value","final","lines","innerHTML","trim","split","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","line","relation","SchemaParser","parse","push","toFormattedString","err","return","join","./parser","2","_defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","Constructor","protoProps","staticProps","prototype","_typeof","obj","constructor","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","ReferenceError","_assertThisInitialized","_wrapNativeSuper","Class","_cache","Map","fn","Function","toString","indexOf","has","get","set","Wrapper","_construct","arguments","_getPrototypeOf","this","create","_setPrototypeOf","Parent","args","Reflect","construct","sham","Proxy","Date","isNativeReflectConstruct","apply","bind","setPrototypeOf","__proto__","getPrototypeOf","Relation","Attribute","ParseError","_Error","message","_this","subClass","superClass","_inherits","name","primary_key","foreign_key","foreign_key_n","result","attributes","primary_keys","foreign_keys","attribute","console","log","pk","sep","wrapAttribute","att","concat","tuple","_att","data","size","pointer","_parse","error","relation_name","read","FK_RE","PK_RE","ATT_RE","try_read","m","add_attribute","_m","_attribute","substr","remaining","match","pattern","peek","eat_whitespace","RegExp","source"],"mappings":"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","file":"app.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n\nvar _parser = require(\"./parser\");\n\n(function () {\n  var areas = document.querySelectorAll('.schema');\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = areas[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var area = _step.value;\n      var final = [];\n      var lines = area.innerHTML.trim().split('\\n');\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = lines[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var line = _step2.value;\n          line = line.trim();\n\n          if (!line) {\n            final.push('<br>');\n            continue;\n          }\n\n          var parser = new _parser.SchemaParser(line);\n          var relation = parser.parse();\n          final.push(relation.toFormattedString());\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      area.innerHTML = final.join('\\n');\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return != null) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n})();\n\n},{\"./parser\":2}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SchemaParser = exports.Relation = exports.Attribute = void 0;\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar ParseError =\n/*#__PURE__*/\nfunction (_Error) {\n  _inherits(ParseError, _Error);\n\n  function ParseError(message) {\n    var _this;\n\n    _classCallCheck(this, ParseError);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ParseError).call(this));\n    _this.message = message;\n    return _this;\n  }\n\n  return ParseError;\n}(_wrapNativeSuper(Error));\n\nvar Attribute =\n/*#__PURE__*/\nfunction () {\n  function Attribute(name) {\n    _classCallCheck(this, Attribute);\n\n    this.name = name;\n    this.primary_key = false;\n    this.foreign_key = false;\n    this.foreign_key_n = 0;\n  }\n\n  _createClass(Attribute, [{\n    key: \"toString\",\n    value: function toString() {\n      var result = this.name;\n\n      if (this.foreign_key) {\n        result += ' [fk' + (this.foreign_key_n === 0 ? '' : this.foreign_key_n.toString()) + ']';\n      }\n\n      return result;\n    }\n  }]);\n\n  return Attribute;\n}();\n\nexports.Attribute = Attribute;\n\nvar Relation =\n/*#__PURE__*/\nfunction () {\n  function Relation(name) {\n    _classCallCheck(this, Relation);\n\n    this.name = name;\n    this.attributes = [];\n    this.primary_keys = [];\n    this.foreign_keys = [];\n  }\n\n  _createClass(Relation, [{\n    key: \"add_attribute\",\n    value: function add_attribute(attribute) {\n      if (attribute.foreign_key) {\n        if (this.foreign_keys.length === 1) {\n          this.foreign_keys[0].foreign_key_n = 1;\n        }\n\n        if (this.foreign_keys.length !== 0) {\n          attribute.foreign_key_n = this.foreign_keys.length + 1;\n        }\n\n        this.foreign_keys.push(attribute);\n        console.log(attribute);\n      }\n\n      if (attribute.primary_key) {\n        this.primary_keys.push(attribute);\n      } else {\n        this.attributes.push(attribute);\n      }\n    }\n  }, {\n    key: \"toFormattedString\",\n    value: function toFormattedString() {\n      var pk = '';\n      var sep = '<span class=\"relation-sep\">,</span> ';\n\n      var wrapAttribute = function wrapAttribute(att) {\n        return \"<span class=\\\"relation-attribute\".concat(att.foreign_key ? ' relation-fk' : '', \"\\\">\").concat(att.toString(), \"</span>\");\n      };\n\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = this.primary_keys[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var att = _step.value;\n          pk += wrapAttribute(att) + sep;\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      var tuple = [];\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = this.attributes[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var _att = _step2.value;\n          tuple.push(wrapAttribute(_att));\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      return '<code class=\"relation\">' + \"<span class=\\\"relation-name\\\">\".concat(this.name, \"</span>\") + '<span class=\"relation-tuple\">' + '<span class=\"relation-open–tuple\">(</span>' + \"<span class=\\\"relation-pk\\\">\".concat(pk, \"[pk]</span>\").concat(tuple.length ? ' ' : '').concat(tuple.join(sep)) + '<span class=\"relation-close–tuple\">)</span>' + '</span>' + '</code>';\n    }\n  }]);\n\n  return Relation;\n}();\n\nexports.Relation = Relation;\n\nvar SchemaParser =\n/*#__PURE__*/\nfunction () {\n  function SchemaParser(data) {\n    _classCallCheck(this, SchemaParser);\n\n    this.data = data;\n    this.size = data.length;\n    this.pointer = 0;\n    this.relation = null;\n  }\n\n  _createClass(SchemaParser, [{\n    key: \"parse\",\n    value: function parse() {\n      try {\n        this._parse();\n      } catch (error) {\n        if (!(error instanceof ParseError)) {\n          throw error;\n        }\n\n        console.log(error.message);\n      }\n\n      return this.relation;\n    }\n  }, {\n    key: \"_parse\",\n    value: function _parse() {\n      var relation_name = this.read(/[A-Z]+/)[0];\n      this.relation = new Relation(relation_name);\n      this.read(/\\(/);\n      var FK_RE = /\\[fk\\d?]/;\n      var PK_RE = /\\[pk]/;\n      var ATT_RE = /\\w+/;\n\n      while (!this.try_read(PK_RE)) {\n        var m = this.read(ATT_RE);\n        var attribute = new Attribute(m[0]);\n        attribute.primary_key = true;\n\n        if (this.try_read(FK_RE)) {\n          attribute.foreign_key = true;\n        }\n\n        this.read(/,/);\n        this.relation.add_attribute(attribute);\n      }\n\n      while (!this.try_read(/\\)/)) {\n        var _m = this.read(ATT_RE);\n\n        var _attribute = new Attribute(_m[0]);\n\n        if (this.try_read(FK_RE)) {\n          _attribute.foreign_key = true;\n        }\n\n        this.try_read(/,/);\n        this.relation.add_attribute(_attribute);\n      }\n    }\n  }, {\n    key: \"end\",\n    value: function end() {\n      return this.pointer === this.size;\n    }\n  }, {\n    key: \"remaining\",\n    value: function remaining() {\n      return this.data.substr(this.pointer);\n    }\n  }, {\n    key: \"eat_whitespace\",\n    value: function eat_whitespace() {\n      var m = this.remaining().match(/^\\s+/);\n\n      if (m) {\n        this.pointer += m[0].length;\n      }\n    }\n  }, {\n    key: \"try_read\",\n    value: function try_read(pattern) {\n      var result = this.peek(pattern);\n\n      if (result) {\n        this.pointer += result[0].length;\n        this.eat_whitespace();\n      }\n\n      return result;\n    }\n  }, {\n    key: \"peek\",\n    value: function peek(pattern) {\n      pattern = new RegExp('^' + pattern.source);\n      return this.remaining().match(pattern);\n    }\n  }, {\n    key: \"read\",\n    value: function read(pattern) {\n      var result = this.peek(pattern);\n      if (!result) throw new ParseError('invalid match ' + pattern + ' of ' + this.remaining());\n      this.pointer += result[0].length;\n      this.eat_whitespace();\n      return result;\n    }\n  }]);\n\n  return SchemaParser;\n}();\n\nexports.SchemaParser = SchemaParser;\n\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYXBwLmpzIiwic3JjL3BhcnNlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBOztBQUVBOztBQUVBLENBQUMsWUFBWTtBQUNaLE1BQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyxnQkFBVCxDQUEwQixTQUExQixDQUFkO0FBRFk7QUFBQTtBQUFBOztBQUFBO0FBR1oseUJBQW1CLEtBQW5CLDhIQUEwQjtBQUFBLFVBQWYsSUFBZTtBQUN6QixVQUFJLEtBQUssR0FBRyxFQUFaO0FBQ0EsVUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLFNBQUwsQ0FBZSxJQUFmLEdBQXNCLEtBQXRCLENBQTRCLElBQTVCLENBQWQ7QUFGeUI7QUFBQTtBQUFBOztBQUFBO0FBSXpCLDhCQUFpQixLQUFqQixtSUFBd0I7QUFBQSxjQUFmLElBQWU7QUFDdkIsVUFBQSxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUwsRUFBUDs7QUFFQSxjQUFJLENBQUMsSUFBTCxFQUFXO0FBQ1YsWUFBQSxLQUFLLENBQUMsSUFBTixDQUFXLE1BQVg7QUFDQTtBQUNBOztBQUVELGNBQU0sTUFBTSxHQUFHLElBQUksb0JBQUosQ0FBaUIsSUFBakIsQ0FBZjtBQUNBLGNBQUksUUFBUSxHQUFHLE1BQU0sQ0FBQyxLQUFQLEVBQWY7QUFDQSxVQUFBLEtBQUssQ0FBQyxJQUFOLENBQVcsUUFBUSxDQUFDLGlCQUFULEVBQVg7QUFDQTtBQWZ3QjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQWlCekIsTUFBQSxJQUFJLENBQUMsU0FBTCxHQUFpQixLQUFLLENBQUMsSUFBTixDQUFXLElBQVgsQ0FBakI7QUFDQTtBQXJCVztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBc0Ja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LGNBQUw7QUFDQTs7QUFFRCxhQUFPLE1BQVA7QUFDQTs7O3lCQUVJLE8sRUFBUztBQUNiLE1BQUEsT0FBTyxHQUFHLElBQUksTUFBSixDQUFXLE1BQU0sT0FBTyxDQUFDLE1BQXpCLENBQVY7QUFDQSxhQUFPLEtBQUssU0FBTCxHQUFpQixLQUFqQixDQUF1QixPQUF2QixDQUFQO0FBQ0E7Ozt5QkFFSSxPLEVBQVM7QUFDYixVQUFJLE1BQU0sR0FBRyxLQUFLLElBQUwsQ0FBVSxPQUFWLENBQWI7QUFFQSxVQUFJLENBQUMsTUFBTCxFQUFhLE1BQU0sSUFBSSxVQUFKLENBQWUsbUJBQW1CLE9BQW5CLEdBQTZCLE1BQTdCLEdBQXNDLEtBQUssU0FBTCxFQUFyRCxDQUFOO0FBRWIsV0FBSyxPQUFMLElBQWdCLE1BQU0sQ0FBQyxDQUFELENBQU4sQ0FBVSxNQUExQjtBQUNBLFdBQUssY0FBTDtBQUVBLGFBQU8sTUFBUDtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQge1NjaGVtYVBhcnNlcn0gZnJvbSAnLi9wYXJzZXInO1xuXG4oZnVuY3Rpb24gKCkge1xuXHRjb25zdCBhcmVhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zY2hlbWEnKTtcblxuXHRmb3IgKGNvbnN0IGFyZWEgb2YgYXJlYXMpIHtcblx0XHRsZXQgZmluYWwgPSBbXTtcblx0XHRjb25zdCBsaW5lcyA9IGFyZWEuaW5uZXJIVE1MLnRyaW0oKS5zcGxpdCgnXFxuJyk7XG5cblx0XHRmb3IgKGxldCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRsaW5lID0gbGluZS50cmltKCk7XG5cblx0XHRcdGlmICghbGluZSkge1xuXHRcdFx0XHRmaW5hbC5wdXNoKCc8YnI+Jyk7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBwYXJzZXIgPSBuZXcgU2NoZW1hUGFyc2VyKGxpbmUpO1xuXHRcdFx0bGV0IHJlbGF0aW9uID0gcGFyc2VyLnBhcnNlKCk7XG5cdFx0XHRmaW5hbC5wdXNoKHJlbGF0aW9uLnRvRm9ybWF0dGVkU3RyaW5nKCkpO1xuXHRcdH1cblxuXHRcdGFyZWEuaW5uZXJIVE1MID0gZmluYWwuam9pbignXFxuJyk7XG5cdH1cbn0pKCk7XG4iLCIndXNlIHN0cmljdCc7XG5cbmNsYXNzIFBhcnNlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG5cdGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIEF0dHJpYnV0ZSB7XG5cblx0Y29uc3RydWN0b3IobmFtZSkge1xuXHRcdHRoaXMubmFtZSA9IG5hbWU7XG5cdFx0dGhpcy5wcmltYXJ5X2tleSA9IGZhbHNlO1xuXHRcdHRoaXMuZm9yZWlnbl9rZXkgPSBmYWxzZTtcblx0XHR0aGlzLmZvcmVpZ25fa2V5X24gPSAwO1xuXHR9XG5cblx0dG9TdHJpbmcoKSB7XG5cdFx0bGV0IHJlc3VsdCA9IHRoaXMubmFtZTtcblxuXHRcdGlmICh0aGlzLmZvcmVpZ25fa2V5KSB7XG5cdFx0XHRyZXN1bHQgKz0gJyBbZmsnICsgKHRoaXMuZm9yZWlnbl9rZXlfbiA9PT0gMCA/ICcnIDogdGhpcy5mb3JlaWduX2tleV9uLnRvU3RyaW5nKCkpICsgJ10nO1xuXHRcdH1cblxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlbGF0aW9uIHtcblxuXHRjb25zdHJ1Y3RvcihuYW1lKSB7XG5cdFx0dGhpcy5uYW1lID0gbmFtZTtcblx0XHR0aGlzLmF0dHJpYnV0ZXMgPSBbXTtcblx0XHR0aGlzLnByaW1hcnlfa2V5cyA9IFtdO1xuXHRcdHRoaXMuZm9yZWlnbl9rZXlzID0gW107XG5cdH1cblxuXHRhZGRfYXR0cmlidXRlKGF0dHJpYnV0ZSkge1xuXG5cdFx0aWYgKGF0dHJpYnV0ZS5mb3JlaWduX2tleSkge1xuXHRcdFx0aWYgKHRoaXMuZm9yZWlnbl9rZXlzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHR0aGlzLmZvcmVpZ25fa2V5c1swXS5mb3JlaWduX2tleV9uID0gMTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHRoaXMuZm9yZWlnbl9rZXlzLmxlbmd0aCAhPT0gMCkge1xuXHRcdFx0XHRhdHRyaWJ1dGUuZm9yZWlnbl9rZXlfbiA9IHRoaXMuZm9yZWlnbl9rZXlzLmxlbmd0aCArIDE7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuZm9yZWlnbl9rZXlzLnB1c2goYXR0cmlidXRlKTtcblx0XHRcdGNvbnNvbGUubG9nKGF0dHJpYnV0ZSk7XG5cdFx0fVxuXG5cdFx0aWYgKGF0dHJpYnV0ZS5wcmltYXJ5X2tleSkge1xuXHRcdFx0dGhpcy5wcmltYXJ5X2tleXMucHVzaChhdHRyaWJ1dGUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmF0dHJpYnV0ZXMucHVzaChhdHRyaWJ1dGUpO1xuXHRcdH1cblx0fVxuXG5cdHRvRm9ybWF0dGVkU3RyaW5nKCkge1xuXHRcdGxldCBwayA9ICcnO1xuXHRcdGxldCBzZXAgPSAnPHNwYW4gY2xhc3M9XCJyZWxhdGlvbi1zZXBcIj4sPC9zcGFuPiAnO1xuXG5cdFx0bGV0IHdyYXBBdHRyaWJ1dGUgPSAoYXR0KSA9PiB7XG5cdFx0XHRyZXR1cm4gYDxzcGFuIGNsYXNzPVwicmVsYXRpb24tYXR0cmlidXRlJHthdHQuZm9yZWlnbl9rZXkgPyAnIHJlbGF0aW9uLWZrJyA6ICcnfVwiPiR7YXR0LnRvU3RyaW5nKCl9PC9zcGFuPmBcblx0XHR9O1xuXG5cdFx0Zm9yIChsZXQgYXR0IG9mIHRoaXMucHJpbWFyeV9rZXlzKSB7XG5cdFx0XHRwayArPSB3cmFwQXR0cmlidXRlKGF0dCkgKyBzZXA7XG5cdFx0fVxuXG5cdFx0bGV0IHR1cGxlID0gW107XG5cdFx0Zm9yIChsZXQgYXR0IG9mIHRoaXMuYXR0cmlidXRlcykge1xuXHRcdFx0dHVwbGUucHVzaCh3cmFwQXR0cmlidXRlKGF0dCkpO1xuXHRcdH1cblxuXHRcdHJldHVybiAnPGNvZGUgY2xhc3M9XCJyZWxhdGlvblwiPicgK1xuXHRcdFx0YDxzcGFuIGNsYXNzPVwicmVsYXRpb24tbmFtZVwiPiR7dGhpcy5uYW1lfTwvc3Bhbj5gICtcblx0XHRcdCc8c3BhbiBjbGFzcz1cInJlbGF0aW9uLXR1cGxlXCI+JyArXG5cdFx0XHRcdCc8c3BhbiBjbGFzcz1cInJlbGF0aW9uLW9wZW7igJN0dXBsZVwiPig8L3NwYW4+JyArXG5cdFx0XHRcdGA8c3BhbiBjbGFzcz1cInJlbGF0aW9uLXBrXCI+JHtwa31bcGtdPC9zcGFuPiR7dHVwbGUubGVuZ3RoID8gJyAnIDogJyd9JHt0dXBsZS5qb2luKHNlcCl9YCArXG5cdFx0XHRcdCc8c3BhbiBjbGFzcz1cInJlbGF0aW9uLWNsb3Nl4oCTdHVwbGVcIj4pPC9zcGFuPicgK1xuXHRcdFx0Jzwvc3Bhbj4nICtcblx0XHRcdCc8L2NvZGU+Jztcblx0fVxufVxuXG5leHBvcnQgY2xhc3MgU2NoZW1hUGFyc2VyIHtcblxuXHRjb25zdHJ1Y3RvcihkYXRhKSB7XG5cdFx0dGhpcy5kYXRhID0gZGF0YTtcblx0XHR0aGlzLnNpemUgPSBkYXRhLmxlbmd0aDtcblx0XHR0aGlzLnBvaW50ZXIgPSAwO1xuXHRcdHRoaXMucmVsYXRpb24gPSBudWxsO1xuXHR9XG5cblx0cGFyc2UoKSB7XG5cblx0XHR0cnkge1xuXHRcdFx0dGhpcy5fcGFyc2UoKTtcblxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRpZiAoIShlcnJvciBpbnN0YW5jZW9mIFBhcnNlRXJyb3IpKSB7XG5cdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zb2xlLmxvZyhlcnJvci5tZXNzYWdlKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5yZWxhdGlvbjtcblx0fVxuXG5cdF9wYXJzZSgpIHtcblxuXHRcdGxldCByZWxhdGlvbl9uYW1lID0gdGhpcy5yZWFkKC9bQS1aXSsvKVswXTtcblx0XHR0aGlzLnJlbGF0aW9uID0gbmV3IFJlbGF0aW9uKHJlbGF0aW9uX25hbWUpO1xuXG5cdFx0dGhpcy5yZWFkKC9cXCgvKTtcblxuXHRcdGNvbnN0IEZLX1JFID0gL1xcW2ZrXFxkP10vO1xuXHRcdGNvbnN0IFBLX1JFID0gL1xcW3BrXS87XG5cdFx0Y29uc3QgQVRUX1JFID0gL1xcdysvO1xuXG5cdFx0d2hpbGUgKCF0aGlzLnRyeV9yZWFkKFBLX1JFKSkge1xuXHRcdFx0bGV0IG0gPSB0aGlzLnJlYWQoQVRUX1JFKTtcblx0XHRcdGxldCBhdHRyaWJ1dGUgPSBuZXcgQXR0cmlidXRlKG1bMF0pO1xuXHRcdFx0YXR0cmlidXRlLnByaW1hcnlfa2V5ID0gdHJ1ZTtcblxuXHRcdFx0aWYgKHRoaXMudHJ5X3JlYWQoRktfUkUpKSB7XG5cdFx0XHRcdGF0dHJpYnV0ZS5mb3JlaWduX2tleSA9IHRydWU7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMucmVhZCgvLC8pO1xuXHRcdFx0dGhpcy5yZWxhdGlvbi5hZGRfYXR0cmlidXRlKGF0dHJpYnV0ZSk7XG5cdFx0fVxuXG5cdFx0d2hpbGUgKCF0aGlzLnRyeV9yZWFkKC9cXCkvKSkge1xuXHRcdFx0bGV0IG0gPSB0aGlzLnJlYWQoQVRUX1JFKTtcblx0XHRcdGxldCBhdHRyaWJ1dGUgPSBuZXcgQXR0cmlidXRlKG1bMF0pO1xuXG5cdFx0XHRpZiAodGhpcy50cnlfcmVhZChGS19SRSkpIHtcblx0XHRcdFx0YXR0cmlidXRlLmZvcmVpZ25fa2V5ID0gdHJ1ZTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy50cnlfcmVhZCgvLC8pO1xuXHRcdFx0dGhpcy5yZWxhdGlvbi5hZGRfYXR0cmlidXRlKGF0dHJpYnV0ZSk7XG5cdFx0fVxuXHR9XG5cblx0ZW5kKCkge1xuXHRcdHJldHVybiB0aGlzLnBvaW50ZXIgPT09IHRoaXMuc2l6ZTtcblx0fVxuXG5cdHJlbWFpbmluZygpIHtcblx0XHRyZXR1cm4gdGhpcy5kYXRhLnN1YnN0cih0aGlzLnBvaW50ZXIpO1xuXHR9XG5cblx0ZWF0X3doaXRlc3BhY2UoKSB7XG5cdFx0bGV0IG0gPSB0aGlzLnJlbWFpbmluZygpLm1hdGNoKC9eXFxzKy8pO1xuXG5cdFx0aWYgKG0pIHtcblx0XHRcdHRoaXMucG9pbnRlciArPSBtWzBdLmxlbmd0aDtcblx0XHR9XG5cdH1cblxuXHR0cnlfcmVhZChwYXR0ZXJuKSB7XG5cdFx0bGV0IHJlc3VsdCA9IHRoaXMucGVlayhwYXR0ZXJuKTtcblxuXHRcdGlmIChyZXN1bHQpIHtcblx0XHRcdHRoaXMucG9pbnRlciArPSByZXN1bHRbMF0ubGVuZ3RoO1xuXHRcdFx0dGhpcy5lYXRfd2hpdGVzcGFjZSgpO1xuXHRcdH1cblxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH1cblxuXHRwZWVrKHBhdHRlcm4pIHtcblx0XHRwYXR0ZXJuID0gbmV3IFJlZ0V4cCgnXicgKyBwYXR0ZXJuLnNvdXJjZSk7XG5cdFx0cmV0dXJuIHRoaXMucmVtYWluaW5nKCkubWF0Y2gocGF0dGVybik7XG5cdH1cblxuXHRyZWFkKHBhdHRlcm4pIHtcblx0XHRsZXQgcmVzdWx0ID0gdGhpcy5wZWVrKHBhdHRlcm4pO1xuXG5cdFx0aWYgKCFyZXN1bHQpIHRocm93IG5ldyBQYXJzZUVycm9yKCdpbnZhbGlkIG1hdGNoICcgKyBwYXR0ZXJuICsgJyBvZiAnICsgdGhpcy5yZW1haW5pbmcoKSk7XG5cblx0XHR0aGlzLnBvaW50ZXIgKz0gcmVzdWx0WzBdLmxlbmd0aDtcblx0XHR0aGlzLmVhdF93aGl0ZXNwYWNlKCk7XG5cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9XG59XG4iXX0=\n"]}